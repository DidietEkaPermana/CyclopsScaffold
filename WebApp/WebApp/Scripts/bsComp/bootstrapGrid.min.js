//! bootstrapGrid.js
//! version : 1.0.0
//! authors : Didiet Eka Permana (didiet.permana@gmail.com)
//! license : MIT
if(typeof jQuery=="undefined")throw new Error("Grid's JavaScript requires jQuery");+function(n){var t=n.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||t[0]==1&&t[1]==9&&t[2]<1)throw new Error("Grid's JavaScript requires jQuery version 1.9.1 or higher");}(jQuery);+function(n){"use strict";function u(n){return this.each(function(){var t=new i(this,n)})}var t=n("input[name=__RequestVerificationToken]").val(),i=function(n,t){this.rowLen=0;this.totalRow=0;this.serverAction=!1;this.gridName=n.id;this.pageSizeOption=t.pageSizeOption;this.fields=t.fields;this.nullImage=t.nullImage;this.serverAction=t.serverAction;this.transport=t.transport;this.transport.type||(this.transport.type="API");this.transport.create.method||(this.transport.create.method="POST");this.transport.read.method||(this.transport.read.method="GET");this.transport.update.method||(this.transport.update.method="PUT");this.transport["delete"].method||(this.transport["delete"].method="DELETE");this.isReff=t.IsReff;this.caller=t.caller;this.callerInput=t.callerInput;this.formValidator;this.dataGrid=null;this.keyFields;this.init(n)},r;i.VERSION="1.0.0";i.prototype={constructor:i,init:function(t){if(n(t).append(this.templateTable()),this.pageGrid=1,this.headerGrid(),this.pageSizeGrid(),n("#"+this.gridName+"Table_PageSize").selectpicker({style:"btn-default",width:"60px"}),this.getData(),!this.isReff){var i=n(t).parent();n(i).append(this.templateAddEdit());this.bindAddEditComponent();this.formValidator=n("form.form-horizontal").validate();n("#"+this.gridName+"Table_Add").click(this,this.Table_Add_Click);n("#Save"+this.gridName+"_Click").click(this,this.Save_Click)}n("#"+this.gridName+"Table_Search").keyup(this,this.Table_Search_Change);n("#"+this.gridName+"Table_PageSize").change(this,this.Table_PageSize_Change);n("#"+this.gridName+"gridRefresh").click(this,this.refreshData);this.initReff()},templateTable:function(){var n='<div class="bsGridCompCSS container-fluid row clearfix" tabindex="999" id="'+this.gridName+'Table">                    <div class="navbar navbar-default">                        <div class="navbar-header">                            <button class="navbar-toggle" data-target=".navbar-inverse-collapse" data-toggle="collapse" type="button">                                <span class="icon-bar"><\/span>                                <span class="icon-bar"><\/span>                                <span class="icon-bar"><\/span>                            <\/button>                        <\/div>                        <div class="navbar-collapse navbar-inverse-collapse collapse">                            <ul class="nav navbar-nav">                                <li><a href="#" id="'+this.gridName+'Table_Add">Add<\/a><\/li>                            <\/ul>                            <form class="navbar-form navbar-right">                                <input class="form-control col-lg-8" placeholder="Search" type="text" id="'+this.gridName+'Table_Search" />                            <\/form>                        <\/div>                    <\/div>                    <table class="table table-hover">                        <thead id="'+this.gridName+'Table_Header"><\/thead>                        <tbody id="'+this.gridName+'Table_Content"><\/tbody>                    <\/table>                    <div class="navbar navbar-default">                        <div class="navbar-header">                            <button class="navbar-toggle" data-target=".navbar-inverse-collapse" data-toggle="collapse" type="button">                                <span class="icon-bar"><\/span>                                <span class="icon-bar"><\/span>                                <span class="icon-bar"><\/span>                            <\/button>                        <\/div>                        <div class="navbar-collapse navbar-inverse-collapse collapse">                            <ul class="nav navbar-nav navbar-form">                                <li>                                    <select id="'+this.gridName+'Table_PageSize"><\/select>                                <\/li>                            <\/ul>                            <ul class="nav navbar-nav navbar-right">                                <li>                                    <a href="#" id="'+this.gridName+'gridRefresh" >                                        <span class="glyphicon glyphicon-refresh" aria-hidden="true"><\/span>                                    <\/a>                                <\/li>                            <\/ul>                            <ul class="nav navbar-nav navbar-right" id="'+this.gridName+'gridPageBar"><\/ul>                        <\/div>                    <\/div>                <\/div>';return this.isReff?'                     <div class="modal fade" id="'+this.gridName+'Dialog">                         <div class="modal-dialog">                             <div class="modal-content">                                 <div class="modal-header">                                     <button type="button" class="close" data-dismiss="modal" data-toggle="modal" data-target="#'+this.caller+'AddEditModal"><span aria-hidden="true">&times;<\/span><span class="sr-only">Close<\/span><\/button>                                     <h4 class="modal-title">Refference '+this.gridName+'<\/h4>                                 <\/div>                                 <div class="modal-body"> '+n+' <\/div>                                 <div class="modal-footer">                                     <a class="btn btn-default" data-dismiss="modal" data-toggle="modal" data-target="#'+this.caller+'AddEditModal">Close<\/a>                                 <\/div>                             <\/div>                         <\/div>                     <\/div>                 ':n},templateAddEdit:function(){var t,n;for(this.keyFields=this.getKey(),t="",n=0;n<this.keyFields.length;n++)t+='<input type="hidden" class="form-control" id="input'+this.keyFields[n].name+'">';return'                     <div class="bsGridDialogCompCSS modal fade" id="'+this.gridName+'AddEditModal">                         <div class="modal-dialog">                             <div class="modal-content">                                 <div class="modal-header">                                     <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;<\/span><span class="sr-only">Close<\/span><\/button>                                     <h4 class="modal-title">Modal title<\/h4>                                 <\/div>                                 <div class="modal-body">                                     <form class="form-horizontal">                                         '+t+"                                         <fieldset> "+this.componentField()+' <\/fieldset>                                     <\/form>                                 <\/div>                                 <div class="modal-footer">                                     <a class="btn btn-default" data-dismiss="modal">Close<\/a>                                     <button type="button" class="btn btn-primary" id="Save'+this.gridName+'_Click">Save changes<\/button>                                 <\/div>                             <\/div>                         <\/div>                     <\/div>                 '},componentField:function(){for(var u,f,r="",i=this.fields,t=0;t<i.length;t++)if(!i[t].key)if(i[t].datatype=="date")r+='<div class="form-group">                                     <label for="input'+i[t].name+'" class="col-lg-2 control-label">'+i[t].title+'<\/label>                                     <div class="col-lg-6">                                         <input type="datetime" class="form-control" id="input'+i[t].name+'" data-date-format="'+i[t].format+'" placeholder="'+i[t].title+'">                                     <\/div>                                 <\/div>',n("#input"+i[t].name).datetimepicker();else if(i[t].datatype=="image")r+='<div class="form-group">                                     <label for="input'+i[t].name+'" class="col-lg-2 control-label">'+i[t].title+'<\/label>                                     <div class="col-lg-6">                                         <img id="input'+i[t].name+'" src="" width="50" height="50" data-dismiss="modal" data-toggle="modal" data-target=".'+i[t].reff+'Picker" />                                     <\/div>                                 <\/div>';else if(i[t].datatype=="enum"){r+='<div class="form-group">                                     <label for="input'+i[t].name+'" class="col-lg-2 control-label">'+i[t].title+'<\/label>                                     <div class="col-lg-6">                                     <select id="input'+i[t].name+'">';u=i[t].enumdata;for(f in u)r+='<option value="'+f+'">'+u[f]+"<\/option>";r+="<\/select><\/div><\/div>"}else r+=i[t].datatype=="int"?i[t].reff!=null?'<div class="form-group">                                     <label for="input'+i[t].name+'" class="col-lg-2 control-label">'+i[t].title+'<\/label>                                     <div class="col-lg-6"><div class="input-group">                                         <input type="text" class="form-control" id="input'+i[t].name+'" placeholder="'+i[t].title+'">                                         <span class="input-group-btn"><button class="btn btn-default" type="button" data-dismiss="modal" data-toggle="modal" data-target="#'+i[t].reff+'Dialog" id="'+i[t].reff+'_button">...<\/button><\/span>                                     <\/div><\/div>                                 <\/div>':'<div class="form-group">                                     <label for="input'+i[t].name+'" class="col-lg-2 control-label">'+i[t].title+'<\/label>                                     <div class="col-lg-6">                                         <input type="text" class="form-control" id="input'+i[t].name+'" placeholder="'+i[t].title+'">                                     <\/div>                                 <\/div>':i[t].reff!=null?'<div class="form-group">                                     <label for="input'+i[t].name+'" class="col-lg-2 control-label">'+i[t].title+'<\/label>                                     <div class="col-lg-6"><div class="input-group">                                         <input type="text" class="form-control" id="input'+i[t].name+'" placeholder="'+i[t].title+'">                                         <span class="input-group-btn"><button class="btn btn-default" type="button" data-dismiss="modal" data-toggle="modal" data-target="#'+i[t].reff+'Dialog" id="'+i[t].reff+'_button">...<\/button><\/span>                                     <\/div><\/div>                                 <\/div>':'<div class="form-group">                                     <label for="input'+i[t].name+'" class="col-lg-2 control-label">'+i[t].title+'<\/label>                                     <div class="col-lg-6">                                         <input type="text" class="form-control" id="input'+i[t].name+'" placeholder="'+i[t].title+'">                                     <\/div>                                 <\/div>';return r},bindAddEditComponent:function(){for(var i=this.fields,t=0;t<i.length;t++)i[t].display!=!1&&(i[t].datatype=="date"?n("#input"+i[t].name).datetimepicker():i[t].datatype=="image"||(i[t].datatype=="enum"?n("#input"+i[t].name).selectpicker({style:"btn-default",width:"160px"}):i[t].datatype=="int"))},refreshData:function(n){var t=n.data;t.getData()},getData:function(){var i=this,r;r=this.serverAction?{__RequestVerificationToken:t,iPage:this.pageGrid,iLength:this.rowLen,strSearch:""}:{__RequestVerificationToken:t};waitingDialog.show("Please wait",{dialogSize:"sm",progressType:"warning"});n.ajax({method:this.transport.read.method,url:this.transport.read.url,data:r}).success(function(t){var r;i.transport.type=="API"?t.total>0?(i.dataGrid=t.payload,i.totalRow=t.total,i.refreshGrid(),waitingDialog.hide()):t.errors!=null&&t.errors.length>0?alert(t.errors):t.total==0?(waitingDialog.hide(),n("#"+i.gridName+"Table_Content").empty(),r="<tr>",r+='<td colspan="'+fields.length+'">No data exists<\/td>',r+="<\/tr>",n("#"+i.gridName+"Table_Content").append(r)):(waitingDialog.hide(),alert("Generic error")):t.value.length>0?(i.dataGrid=t.value,i.totalRow=t.value.length,i.refreshGrid(),waitingDialog.hide()):t.value.length==0?(waitingDialog.hide(),n("#"+i.gridName+"Table_Content").empty(),r="<tr>",r+='<td colspan="'+fields.length+'">No data exists<\/td>',r+="<\/tr>",n("#"+i.gridName+"Table_Content").append(r)):(waitingDialog.hide(),alert("Generic error"))}).fail(function(n,t,i){waitingDialog.hide();alert("Got some error: "+i)})},refreshGrid:function(){var r,f=this.pageGrid*this.rowLen,u=this.pageGrid*this.rowLen-this.rowLen,s,t;for(this.serverAction&&(u=0),this.serverAction?r=this.dataGrid:(s=n("#"+this.gridName+"Table_Search").val(),r=s.length>0?this.filterData(s):this.dataGrid),f>r.length&&(f=r.length),u>f&&(u=0,f=this.rowLen,f>r.length&&(f=r.length)),n("#"+this.gridName+"Table_Content").empty(),t=this.fields;u<f;u++){for(var e="<tr>",i=0,o="";i<t.length;i++)t[i].display!=!1&&(e+=t[i].datatype=="date"?"<td>"+moment(r[u][t[i].name]).format(t[i].format)+"<\/td>":t[i].datatype=="image"?r[u][t[i].name]==null?'<td><img src="'+this.nullImage+'" width="30px" height="30px"><\/td>':'<td><img src="'+r[u][t[i].name]+'" width="30px" height="30px"><\/td>':t[i].datatype=="enum"?"<td>"+t[i].enumdata[r[u][t[i].name]]+"<\/td>":t[i].datatype=="int"?t[i].reff!=null?"<td>"+this.reffName(r[u],t[i].reffName)+"<\/td>":"<td>"+r[u][t[i].name]+"<\/td>":t[i].reff!=null?"<td>"+this.reffName(r[u],t[i].reffName)+"<\/td>":"<td>"+r[u][t[i].name]+"<\/td>"),t[i].key==!0&&(o+=r[u][t[i].name]);e+=this.isReff?'<td><button type="button" class="btn btn-default btn-xs '+this.gridName+'Table_Choose_Click" data-id="'+o+'" data-name="'+r[u][t[1].name]+'">Choose<\/button><\/td>':'<td><button type="button" class="btn btn-default btn-xs '+this.gridName+'Table_Edit_Click" data-id="'+o+'">Edit<\/button>&nbsp;<button type="button" class="btn btn-default btn-xs '+this.gridName+'Table_Delete_Click" data-id="'+o+'">Delete<\/button><\/td>';e+="<\/tr>";n("#"+this.gridName+"Table_Content").append(e)}this.isReff?n("."+this.gridName+"Table_Choose_Click").click(this,this.gridPageBar_Choose):(n("."+this.gridName+"Table_Edit_Click").click(this,this.gridPageBar_Edit),n("."+this.gridName+"Table_Delete_Click").click(this,this.gridPageBar_Delete));this.gridPageBar_init(r)},pageSizeGrid:function(){n("#"+this.gridName+"Table_PageSize").empty();for(var t=0;t<this.pageSizeOption.length;t++)t==0&&(this.rowLen=this.pageSizeOption[t]),n("#"+this.gridName+"Table_PageSize").append("<option>"+this.pageSizeOption[t]+"<\/option>")},headerGrid:function(){var t,i;for(n("#"+this.gridName+"Table_Header").empty(),t="<tr>",i=0;i<this.fields.length;i++)this.fields[i].display!=!1&&(t+="<th>"+this.fields[i].title+"<\/th>");t+="<th><\/th>";t+="<\/tr>";n("#"+this.gridName+"Table_Header").append(t)},Table_Search_Change:function(t){var i=t.data,r=n("#"+i.gridName+"Table_Search").val();r.length>=3?(i.pageGrid=1,i.refreshGrid()):r.length==0&&(i.pageGrid=1,i.refreshGrid())},Table_PageSize_Change:function(t){var i=t.data;typeof i.dataGrid!="undefined"&&(i.rowLen=n("#"+i.gridName+"Table_PageSize").val(),i.pageGrid=1,i.serverAction?i.getData():i.refreshGrid())},Table_Add_Click:function(t){var i=t.data,r;for(i.formValidator.resetForm(),n("form.form-horizontal","#"+i.gridName+"AddEditModal")[0].reset(),n("#"+i.gridName+"AddEditModal .modal-title").html(i.gridName+" add"),r=0;r<i.keyFields.length;r++)i.keyFields[r].datatype=="int"?n("#input"+i.keyFields[r].name).val(0):n("#input"+i.keyFields[r].name).val("");n("#"+i.gridName+"AddEditModal").modal()},gridPageBar_init:function(t){var u=t.length,f,r,i;this.serverAction&&(u=this.totalRow);f=u%this.rowLen;r=(u-f)/this.rowLen;f>0&&r++;n("#"+this.gridName+"gridPageBar").empty();i="";this.pageGrid==1?(i+='<li class="disabled"><a href="#"><span class="glyphicon glyphicon-fast-backward"><\/span><\/a><\/li>',i+='<li class="disabled"><a href="#"><span class="glyphicon glyphicon-backward"><\/span><\/a><\/li>'):(i+='<li><a href="#" id="'+this.gridName+'FirstPage" data-page="1"><span class="glyphicon glyphicon-fast-backward"><\/span><\/a><\/li>',i+='<li><a href="#" id="'+this.gridName+'PrevPage" data-page="'+(this.pageGrid-1)+'"><span class="glyphicon glyphicon-backward"><\/span><\/a><\/li>');i+='<li><a href="#">Page '+this.pageGrid+" of "+r+"<\/a><\/li>";this.pageGrid==r?(i+='<li class="disabled"><a href="#"><span class="glyphicon glyphicon-forward"><\/span><\/a><\/li>',i+='<li class="disabled"><a href="#"><span class="glyphicon glyphicon-fast-forward"><\/span><\/a><\/li>'):(i+='<li><a href="#" id="'+this.gridName+'NextPage" data-page="'+(this.pageGrid+1)+'"><span class="glyphicon glyphicon-forward"><\/span><\/a><\/li>',i+='<li><a href="#" id="'+this.gridName+'LastPage" data-page="'+r+'"><span class="glyphicon glyphicon-fast-forward"><\/span><\/a><\/li>');n("#"+this.gridName+"gridPageBar").append(i);n("#"+this.gridName+"FirstPage").click(this,this.gridPageBar_Change);n("#"+this.gridName+"PrevPage").click(this,this.gridPageBar_Change);n("#"+this.gridName+"NextPage").click(this,this.gridPageBar_Change);n("#"+this.gridName+"LastPage").click(this,this.gridPageBar_Change)},gridPageBar_Change:function(t){var i=t.data;i.pageGrid=n(this).data("page");i.serverAction?i.getData():i.refreshGrid()},filterData:function(n){for(var u=[],r=0;r<this.dataGrid.length;r++){for(var t=0,f="",i=this.fields;t<i.length;t++)i[t].display!=!1&&(f+=i[t].datatype=="date"?moment(this.dataGrid[r][i[t].name]).format(i[t].format):this.dataGrid[r][i[t].name]);f.toLowerCase().indexOf(n.toLowerCase())>=0&&u.push(this.dataGrid[r])}return u},gridPageBar_Choose:function(t){var i=t.data,r=n(this).data("id"),u=n(this).data("name");n("#"+i.gridName+"Dialog").modal("hide");n("#input"+i.callerInput).val(u);n("#input"+i.callerInput).data("id",r);n("#"+i.caller+"AddEditModal").modal()},gridPageBar_Edit:function(t){var i=t.data,u=n(this).data("id"),f,r;for(i.formValidator.resetForm(),n("form.form-horizontal","#"+i.gridName+"AddEditModal")[0].reset(),n("#"+i.gridName+"AddEditModal .modal-title").html(i.gridName+" edit "+u),r=0;r<i.keyFields.length;r++)f=i.getObjects(i.dataGrid,i.keyFields[r].name,u),n("#Input"+i.keyFields[r].name).val(u);f.length>0?(i.fillAddEdit(f),n("#"+i.gridName+"AddEditModal").modal()):alert("Error retrieving data")},fillAddEdit:function(t){for(var r=this.fields,i=0;i<r.length;i++)r[i].datatype=="date"?n("#input"+r[i].name).val(moment(t[0][r[i].name]).format(r[i].format)):r[i].datatype=="image"?t[0].SourceIcon==null?n("#input"+r[i].name).attr("src",this.nullImage):n("#input"+r[i].name).attr("src",t[0][r[i].name]):r[i].datatype=="enum"?n("#input"+r[i].name).selectpicker("val",t[0][r[i].name]):r[i].datatype=="int"?r[i].reff!=null?(n("#input"+r[i].name).val(this.reffName(t[0],r[i].reffName)),n("#input"+r[i].name).data("id",t[0][r[i].name])):n("#input"+r[i].name).val(t[0][r[i].name]):r[i].reff!=null?(n("#input"+r[i].name).val(this.reffName(t[0],r[i].reffName)),n("#input"+r[i].name).data("id",t[0][r[i].name])):n("#input"+r[i].name).val(t[0][r[i].name])},gridPageBar_Delete:function(i){var r=i.data,u;confirm("Are you sure you want to delete this record?")&&(waitingDialog.show("Please wait",{dialogSize:"sm",progressType:"warning"}),u=r.transport.delete.url,r.transport.delete.method!="POST"&&(u+=r.transport.type=="API"?"/"+n(this).data("id"):"("+n(this).data("id")+")"),n.ajax({method:r.transport.delete.method,url:u,data:{__RequestVerificationToken:t,id:n(this).data("id")}}).success(function(n){r.transport.type=="API"?n.total>=0?(waitingDialog.hide(),alert("Record deleted"),r.getData()):n.errors.length>0?(waitingDialog.hide(),alert(n.errors)):(waitingDialog.hide(),alert("Generic error")):(waitingDialog.hide(),alert("Record deleted"),r.getData())}).fail(function(n,t,i){waitingDialog.hide();alert("Got some error: "+i)}))},initReff:function(){for(var t=this.fields,n=0;n<t.length;n++)t[n].reff!=undefined&&window[t[n].reff]()},reffName:function(n,t){for(var i=n,u=t.split("."),r=0;r<u.length;r++)i=i[u[r]];return i},Save_Click:function(i){var r=i.data,f=r.fields,e,u,o,s,h;if(r.formValidator.valid()){for(e={},e.__RequestVerificationToken=t,u=0;u<f.length;u++)e[f[u].name]=f[u].datatype=="date"?n("#input"+f[u].name).val():f[u].datatype=="image"?n("#input"+f[u].name).attr("src"):f[u].datatype=="enum"?n("#input"+f[u].name).selectpicker("val"):f[u].datatype=="int"?f[u].reff!=null?n("#input"+f[u].name).data("id"):n("#input"+f[u].name).val():f[u].reff!=null?n("#input"+f[u].name).data("id"):n("#input"+f[u].name).val();for(waitingDialog.show("Please wait",{dialogSize:"sm",progressType:"warning"}),o="",s=0;s<r.keyFields.length;s++)o=e[r.keyFields[s].name];e.id=o;o==0?n.ajax({method:r.transport.create.method,url:r.transport.create.url,data:e}).success(function(t){r.transport.type=="API"?t.total>=0?(n("#"+r.gridName+"AddEditModal").modal("hide"),r.getData(),waitingDialog.hide()):t.errors.length>0?(waitingDialog.hide(),alert(t.errors)):(waitingDialog.hide(),alert("Generic error")):(n("#"+r.gridName+"AddEditModal").modal("hide"),r.getData(),waitingDialog.hide())}).fail(function(n,t,i){waitingDialog.hide();alert("Got some error: "+i)}):(h=r.transport.update.url,r.transport.update.method!="POST"&&(h+=r.transport.type=="API"?"/"+o:"("+o+")"),n.ajax({method:r.transport.update.method,url:h,data:e}).success(function(t){r.transport.type=="API"?t.total>=0?(n("#"+r.gridName+"AddEditModal").modal("hide"),r.getData(),waitingDialog.hide()):t.errors.length>0?(waitingDialog.hide(),alert(t.errors)):(waitingDialog.hide(),alert("Generic error")):(n("#"+r.gridName+"AddEditModal").modal("hide"),r.getData(),waitingDialog.hide())}).fail(function(n,t,i){waitingDialog.hide();alert("Got some error: "+i)}))}},getObjects:function(n,t,i){var r=[];for(var u in n)n.hasOwnProperty(u)&&(typeof n[u]=="object"?r=r.concat(this.getObjects(n[u],t,i)):u==t&&n[t]==i&&r.push(n));return r},getKey:function(){for(var t=this.fields,i=[],n=0;n<t.length;n++)t[n].key&&i.push(t[n]);return i}};r=n.fn.grid;n.fn.grid=u;n.fn.grid.noConflict=function(){return n.fn.grid=r,this}}(jQuery);
//# sourceMappingURL=bootstrapGrid.min.js.map
